<!DOCTYPE HTML>
<head>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="default.css">
  <link rel="stylesheet" href="https://tls.homeinfo.de/css/immobrowse.css">
  <link rel="stylesheet" href="https://www.w3schools.com/lib/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" type="text/css" href="lib/sweetalert2.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://www.google.com/recaptcha/api.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src="lib/sweetalert2.min.js"></script>
  <script src="https://tls.homeinfo.de/javascript/immobrowse.js"></script>
  <script>
    $(document).ready(function () {
      immobrowse.config.exposeContainer = document.getElementById('containerdetails');
      if (getUrlParameter('cid') == undefined || getUrlParameter('cid') == getUrlParameter('extern'))
        immobrowse.config.exposeContainer.innerHTML = "Immobilie konnte nicht gefunden werden.";
      else
        immobrowse.getRealEstate(getUrlParameter('extern'), getUrlParameter('cid'));
        //immobrowse.getRealEstate("0003.0377.0046", "1028001");
    });

    function getUrlParameter(sParam) {
      var sPageURL = decodeURIComponent(window.location.search.substring(1));
      var sURLVariables = sPageURL.split('&');
      var sParameterName;
      for (var i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] === sParam) {
          return sParameterName[1] === undefined ? true : sParameterName[1];
        }
      }
    };

    function sendEmail(config) {
      var response = grecaptcha.getResponse();
      var mailer = immobrowse.getMailer(config, response);
      var surname = document.getElementById('surname').value;
      var given_name = document.getElementById('given_name').value;
      var message = document.getElementById('message').value;
      var html = immobrowse.mkHtmlMsg(surname, given_name, message);
      var email = document.getElementById('email').value;
      mailer('Immobilienanfrage', html, email);
    }
  </script>
</head>
<div id="main">
  <div id="loader" class="loader"></div>
  <div id="containerdetails">Immobilie wird aufgerufen, bitte warten...</div>
  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#contact_form">
    Kontaktformular
  </button>

  <!-- Modal -->
  <div id="contact_form" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Kontaktformular</h4>
        </div>
        <div class="modal-body">
          <table>
            <tr>
              <td>Name:</td>
              <td><input type="text" id="surname"></td>
            </tr>
            <tr>
              <td>Vorname:</td>
              <td><input type="text" id="given_name"></td>
            </tr>
            <tr>
              <td>E-Mail Adresse:</td>
              <td><input type="text" id="email"></td>
            </tr>
            <tr>
              <td>Ihre Nachricht:</td>
              <td><input type="text" id="message" class="ib-contact-textfield"></td>
            </tr>
          </table>
          <div class="g-recaptcha" data-sitekey="6LctzhATAAAAADfc-ph7GHVYQ68y9lY4rYwV0Zft"></div>
          <button id="send_mail" onclick=sendEmail('homeinfo-testing');>Absenden</button>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
</div>
