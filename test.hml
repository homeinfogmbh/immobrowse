<!DOCTYPE HTML>
<head>
    <link rel="stylesheet" href="stylesheet.css">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="immobrowse.js"></script>
    <script>
        var realEstates = [];


        function startLoading() {
            var loader = document.getElementById('loader');
            loader.style.display = 'block';
        }


        function stopLoading() {
            var loader = document.getElementById('loader');
            loader.style.display = 'none';
        }


        function sortByRoomsAsc() {
            realEstates = realEstates.sort(immobrowse.sortByRooms(false));
        }


        function sortByRoomsDesc() {
            realEstates = realEstates.sort(immobrowse.sortByRooms(true));
        }


        function sortByAreaAsc() {
            realEstates = realEstates.sort(immobrowse.sortByArea(false));
        }


        function sortByAreaDesc() {
            realEstates = realEstates.sort(immobrowse.sortByArea(true));
        }


        function printPreviews() {
            var html = '<table>';

            for (realEstate of realEstates) {
                html += '<tr><td>' + immobrowse.preview(realEstate) + '</td></tr>';
            }

            document.getElementById('container').innerHTML = html + '</table>';
        }


        function getRealEstates() {
            var session = document.getElementById('session').value;
            startLoading();

            $.ajax({
                url: 'https://tls.homeinfo.de/his/realestates/data?session=' + session,
                success: function(json) {
                    realEstates = json.immobilie;
                    stopLoading();
                    printPreviews();
                }
            });
        }


        function test() {
            var x = null;
            console.log(x.foo);
        }
    </script>
</head>
<body>
    Session token: <input id="session"/><br/>
    <button id="query" onclick="getRealEstates()">Query real estates</button>
    <br/>
    <button id="sortByRoomsAsc" onclick="sortByRoomsAsc()">Sort by rooms ascending</button>
    <button id="sortByRoomsDesc" onclick="sortByRoomsDesc()">Sort by rooms descending</button>
    <br/>
    <button id="sortByAreaAsc" onclick="sortByAreaAsc()">Sort by area ascending</button>
    <button id="sortByAreaDesc" onclick="sortByAreaDesc()">Sort by area descending</button>
    <br/>
    <button id="printPreviews" onclick="printPreviews()">Print</button>
    <br/>
    <button id="test" onclick="test()">Test</button>
    <div id="container">Real estates go here.</div>
    <div id="loader" class="loader"></div>
</body>
